Answer the following questions using the chinook database:

(https://raw.githubusercontent.com/lerocha/chinook-database/refs/heads/master/ChinookDatabase/DataSources/Chinook_Sqlite.sql)

Each question should be answered with a signle query (but JOINs and subqueries are ok).

1. Who's the customer who has spent the most?

2. What's the title of the longest album? (most minutes of music)

3. What's the title of the shortest album? (fewest minutes of music)

4. What's the title of the album with the most songs?

5- What's the title of the album with the fewest songs?

6. What's the title of the album with the longest title (most characters in album name)?

7. What's the title of the album with the shorest title (fewest characters in album name)? 

--------------------------------------------------------------------------------------

1. Who's the customer who has spent the most?
Query:
SELECT c.FirstName || ' ' || c.LastName AS CustomerName, SUM(i.Total) AS TotalSpent 
FROM Customer c 
JOIN Invoice i ON c.CustomerId = i.CustomerId 
GROUP BY c.CustomerId 
ORDER BY TotalSpent DESC 
LIMIT 1;

Answer: Helena Holý ($49.62)

2. What's the title of the longest album? (most minutes of music)
Query:
SELECT a.Title, SUM(t.Milliseconds) AS TotalMilliseconds 
FROM Album a 
JOIN Track t ON a.AlbumId = t.AlbumId 
GROUP BY a.AlbumId 
ORDER BY TotalMilliseconds DESC 
LIMIT 1;

Answer: Lost, Season 3 (70,665,582 milliseconds ≈ 1,178 minutes)

3. What's the title of the shortest album? (fewest minutes of music)
Query:
SELECT a.Title, SUM(t.Milliseconds) AS TotalMilliseconds 
FROM Album a 
JOIN Track t ON a.AlbumId = t.AlbumId 
GROUP BY a.AlbumId 
ORDER BY TotalMilliseconds ASC 
LIMIT 1;

Answer: Liszt - 12 Études D'Execution Transcendante (51,780 milliseconds ≈ 0.86 minutes)

4. What's the title of the album with the most songs?
Query:
SELECT a.Title, COUNT(t.TrackId) AS TrackCount 
FROM Album a 
JOIN Track t ON a.AlbumId = t.AlbumId 
GROUP BY a.AlbumId 
ORDER BY TrackCount DESC 
LIMIT 1;

Answer: Greatest Hits (57 tracks)

5. What's the title of the album with the fewest songs?
Query:
SELECT a.Title, COUNT(t.TrackId) AS TrackCount 
FROM Album a 
JOIN Track t ON a.AlbumId = t.AlbumId 
GROUP BY a.AlbumId 
ORDER BY TrackCount ASC 
LIMIT 1;

Answer: Balls to the Wall (1 track)

6. What's the title of the album with the longest title (most characters in album name)?
Query:
SELECT Title, LENGTH(Title) AS TitleLength 
FROM Album 
ORDER BY TitleLength DESC 
LIMIT 1;

Answer: Tchaikovsky: 1812 Festival Overture, Op.49, Capriccio Italien & Beethoven: Wellington's Victory (95 characters)

7. What's the title of the album with the shortest title (fewest characters in album name)?
Query:
SELECT Title, LENGTH(Title) AS TitleLength 
FROM Album 
ORDER BY TitleLength ASC 
LIMIT 1;

Answer: IV (2 characters) 




